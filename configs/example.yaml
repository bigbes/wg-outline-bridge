---
log_level: "info"
# cache_dir: "/var/cache/wg-outline-bridge"  # cache for downloaded files (default: ~/.cache/wg-outline-bridge)

# observability_http:              # Single HTTP server for observability endpoints
#   addr: ":6060"                  # listen address (empty = disabled)
#   pprof: true                    # serve /debug/pprof/* (Go profiling)
#   metrics: true                  # serve /metrics (Prometheus)

wireguard:
  private_key: "CHANGE_ME_BASE64_PRIVATE_KEY"
  listen_port: 51820
  address: "10.100.0.1/24"
  public_address: ""  # server's public IP, used for client config generation
  mtu: 1420
  dns: "1.1.1.1"
  # mode: "amneziawg"          # "wireguard" (default) or "amneziawg" (DPI-resistant)
  # amneziawg:                 # AmneziaWG obfuscation params (only when mode: amneziawg)
  #   jc: 4                    # junk packet count (sent before each handshake)
  #   jmin: 50                 # minimum junk packet size
  #   jmax: 1000               # maximum junk packet size
  #   s1: 20                   # handshake init padding
  #   s2: 20                   # handshake response padding
  #   s3: 0                    # underload packet padding (AWG 2.0)
  #   s4: 0                    # transport packet padding (AWG 2.0)
  #   h1: "100-200"            # handshake init header (single value or range)
  #   h2: "100-200"            # handshake response header
  #   h3: "100-200"            # cookie message header
  #   h4: "100-200"            # transport message header
  #   i1: "<b 0xHEX>"          # special junk packet 1 (AWG 1.5+; hex-encoded protocol signature)
  #   i2: ""                   # special junk packet 2
  #   i3: ""                   # special junk packet 3
  #   i4: ""                   # special junk packet 4
  #   i5: ""                   # special junk packet 5

# dns:                         # Built-in DNS proxy server
#   enabled: true
#   listen: "127.0.0.1:15353"  # defaults to 127.0.0.1:15353; port-53 traffic from WG clients is intercepted by gVisor
#   upstream: "1.1.1.1:53"     # defaults to wireguard dns :53
#   records:                   # static local records (highest priority)
#     myhost.internal:
#       a: ["10.100.0.10"]
#       aaaa: ["fd00::1"]      # optional IPv6 addresses
#       ttl: 60
#   rules:                     # evaluated in order, first match wins
#     - name: "ads"
#       action: block
#       lists:
#         - url: "https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts"
#           format: hosts      # hosts, domains, domains-wildcards, adblock, or auto (default: auto)
#           refresh: 86400
#         - url: "https://abp.oisd.nl/big/"
#           format: domains
#     - name: "ru-direct-dns"
#       action: upstream
#       upstream: "77.88.8.8:53"
#       domains:
#         - "*.ru"
#         - "*.yandex.com"
#     - name: "custom-block"
#       action: block
#       domains:
#         - "telemetry.example.com"

# mtproxy:                    # MTProxy server (Telegram proxy protocol)
#   enabled: true
#   listen:
#     - "0.0.0.0:443"
#   upstream_group: "default"  # upstream group name for backend connections
#   # secrets are managed via database (use 'bridge gensecret' to add)
#   stats_addr: "127.0.0.1:8080"  # HTTP stats endpoint (localhost-only, GET /stats)
#   fake_tls:                  # fake TLS handshake for censorship resistance
#     enabled: false
#     sni:                     # allowed SNI hostnames (first is used in client proxy links)
#       - "www.google.com"
#       - "www.cloudflare.com"
#     max_clock_skew_seconds: 600
#     replay_cache_ttl_hours: 48
#   endpoints:                 # override Telegram DC endpoints (optional)
#     1: ["149.154.175.50:443"]
#     2: ["149.154.167.51:443"]

# proxies:                      # SOCKS5 / HTTP / HTTPS forward proxy servers
#   - name: "socks-main"
#     type: socks5
#     listen: "0.0.0.0:1080"
#     upstream_group: ""         # upstream group name
#     username: ""               # optional: enable user/pass authentication
#     password: ""
#
#   - name: "http-main"
#     type: http
#     listen: "0.0.0.0:8080"
#     username: "user"           # HTTP Basic auth
#     password: "pass"
#
#   - name: "https-secure"
#     type: https
#     listen: "0.0.0.0:8443"
#     username: "user"
#     password: "pass"
#     tls:
#       # Option 1: manual cert files
#       cert_file: "/path/to/cert.pem"
#       key_file: "/path/to/key.pem"
#       # Option 2: automatic Let's Encrypt (requires valid domain)
#       # domain: "proxy.example.com"
#       # acme_email: "admin@example.com"

# database:                                         # SQLite database for persistent stats + peer/secret management
#   path: "/var/lib/wg-outline-bridge/bridge.sqlite"  # empty or omitted = disabled
#   flush_interval: 30                                # seconds (default: 30)

# telegram:                     # Telegram bot for observation & commands
#   enabled: true
#   token: "123456:ABC-DEF..."   # Bot API token from @BotFather
#   chat_id: -1001234567890      # (optional) Chat ID for periodic status push
#   interval: 300                # Status push interval in seconds (default: 300)
#   allowed_users:               # (optional) Only these user IDs can use the bot in private chats
#     - 123456789

# miniapp:                       # Telegram Mini App (web admin panel)
#   enabled: true
#   listen: ":443"               # HTTPS listen address (default: ":443")
#   domain: "admin.example.com"  # public domain (required; Telegram requires HTTPS)
#   acme_email: "admin@example.com"  # optional email for Let's Encrypt notifications

upstreams:
  - name: "default"
    type: outline
    transport: "ss://CHANGE_ME"
    default: true
#   enabled: true                # enabled by default; set false to disable
#   groups: ["video"]            # custom groups for upstream_group references
#   health_check:
#     enabled: true
#     interval: 30               # seconds
#     target: "1.1.1.1:80"
#  - name: "alt"
#    type: outline
#    transport: "ss://CHANGE_ME_ALT"
#    groups: ["video"]

# geoip:                     # GeoIP MMDB databases for country-based routing
#   - name: "country"         # name used in geoip: references (optional)
#     path: "/path/to/GeoLite2-Country.mmdb"  # local path or URL
#     refresh: 86400          # reload interval in seconds (default: 86400)
#   - name: "alt"
#     path: "https://example.com/GeoIP2-Country.mmdb"
#     refresh: 604800

# routing:
#   enabled: true               # enable routing rules (default: true when routing section present)
#   cidrs:                    # CIDR rules for client WireGuard AllowedIPs
#     - "d:{{ $server_ip }}/32" # exclude server's own public IP (template variable)
#     - "d:192.168.0.0/16"    # disallow local network (traffic goes direct)
#     - "a:*"                 # allow all (default base: 0.0.0.0/0)
#     # Supported formats:
#     #   allow:<range>  or  a:<range>   — include CIDR in AllowedIPs
#     #   disallow:<range> or d:<range>  — exclude CIDR from AllowedIPs
#     #   a:*  — allow all (0.0.0.0/0)
#     #   d:*  — disallow all
#     #   bare CIDR (e.g. "192.168.0.0/16") — treated as disallow
#     # Template variables ({{ $var_name }}):
#     #   {{ $server_ip }} — server's public IP (from wireguard.public_address or auto-detected)
#
#   ip_rules:
#     - name: "private-networks"
#       action: direct
#       cidrs:
#         - "10.0.0.0/8"
#         - "172.16.0.0/12"
#         - "192.168.0.0/16"
#
#     - name: "country-bypass"
#       action: direct
#       cidrs:
#         - "geoip:RU"            # match by country using first (default) DB
#         - "geoip:BY"
#         - "geoip:alt:UA"        # match using a specific named DB
#
#     - name: "country-bypass-list"
#       action: direct
#       lists:
#         - url: "https://raw.githubusercontent.com/nickvdyck/geoip-country-lists/main/list/cidr/RU.cidr"
#           refresh: 86400
#
#     - name: "cloudflare-direct"
#       action: direct
#       asns:
#         - 13335              # Cloudflare
#
#     - name: "special-via-alt"
#       action: upstream
#       upstream_group: "video"  # route to upstream group
#       cidrs:
#         - "203.0.113.0/24"
#
#   sni_rules:
#     - name: "video-via-alt"
#       action: upstream
#       upstream_group: "video"  # route to upstream group
#       domains:
#         - "*.youtube.com"
#         - "*.googlevideo.com"
#
#     - name: "direct-domains"
#       action: direct
#       domains:
#         - "*.ru"
#         - "*.yandex.com"
#
#   port_rules:
#     - name: "block-torrent-ports"
#       action: block
#       ports:
#         - "6881-6889"          # default BitTorrent ports
#         - "6969"               # common tracker port
#
#   protocol_rules:
#     - name: "block-bittorrent"
#       action: block
#       protocols:
#         - bittorrent           # detects BT handshake (TCP), DHT & tracker (UDP)
